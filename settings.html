<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alert Electron ì„¤ì •</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      padding: 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 24px;
    }
    .subtitle {
      color: #666;
      margin-bottom: 20px;
      font-size: 14px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
      font-size: 14px;
    }
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 10px;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      font-size: 14px;
      transition: border-color 0.3s ease;
    }
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
    }
    .form-group .help-text {
      font-size: 12px;
      color: #666;
      margin-top: 5px;
    }
    .toggle-group {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
      margin-bottom: 20px;
    }
    .toggle-group label {
      font-weight: 600;
      color: #333;
      margin: 0;
    }
    .toggle-switch {
      position: relative;
      width: 50px;
      height: 26px;
      background: #ccc;
      border-radius: 13px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .toggle-switch.active {
      background: #667eea;
    }
    .toggle-switch::after {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      background: white;
      border-radius: 50%;
      top: 3px;
      left: 3px;
      transition: left 0.3s ease;
    }
    .toggle-switch.active::after {
      left: 27px;
    }
    .status-box {
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
      margin-bottom: 20px;
    }
    .status-box .status-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 13px;
    }
    .status-box .status-item:last-child {
      margin-bottom: 0;
    }
    .status-box .status-label {
      color: #666;
    }
    .status-box .status-value {
      color: #667eea;
      font-weight: 600;
      font-family: monospace;
    }
    .status-box .status-value.success {
      color: #28a745;
    }
    .status-box .status-value.error {
      color: #dc3545;
    }
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      width: 100%;
      margin-bottom: 10px;
    }
    .btn-primary {
      background: #667eea;
      color: white;
    }
    .btn-primary:hover {
      background: #5568d3;
    }
    .btn-secondary {
      background: #6c757d;
      color: white;
    }
    .btn-secondary:hover {
      background: #5a6268;
    }
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .info-box {
      background: #e7f3ff;
      border-left: 4px solid #667eea;
      padding: 15px;
      border-radius: 4px;
      margin-bottom: 20px;
    }
    .info-box p {
      margin: 0;
      color: #0c5460;
      line-height: 1.6;
      font-size: 13px;
    }
    .warning-box {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 15px;
      border-radius: 4px;
      margin-bottom: 20px;
    }
    .warning-box p {
      margin: 0;
      color: #856404;
      line-height: 1.6;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”” Alert Electron ì„¤ì •</h1>
    <p class="subtitle">NMS ì‹œìŠ¤í…œ ì•Œë¦¼ ì—°ë™ ì„¤ì •</p>
    
    <div class="info-box">
      <p><strong>ì‘ë™ ë°©ì‹:</strong> ì´ ì•±ì€ Next.js APIë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ì¡°íšŒí•˜ì—¬ ìƒˆë¡œìš´ ì•Œë¦¼ì„ ë°›ì•„ í‘œì‹œí•©ë‹ˆë‹¤.</p>
    </div>

    <div id="warning-box" class="warning-box" style="display: none;">
      <p id="warning-text"></p>
    </div>

    <form id="config-form">
      <div class="toggle-group">
        <label>ì•Œë¦¼ í™œì„±í™”</label>
        <div class="toggle-switch" id="enabled-toggle"></div>
      </div>

      <div class="form-group">
        <label for="api-url">API URL *</label>
        <input 
          type="text" 
          id="api-url" 
          value="https://nms-system.vercel.app/api/notifications"
          placeholder="https://nms-system.vercel.app/api/notifications"
          required
        >
        <div class="help-text">
          <strong>í•„ìˆ˜:</strong> Next.js ì•Œë¦¼ API ì—”ë“œí¬ì¸íŠ¸<br>
          í”„ë¡œë•ì…˜: <code>https://nms-system.vercel.app/api/notifications</code><br>
          ê°œë°œ í™˜ê²½: <code>http://localhost:3000/api/notifications</code>
        </div>
      </div>

      <div class="form-group">
        <label for="email">ì´ë©”ì¼ *</label>
        <input 
          type="email" 
          id="email" 
          placeholder="ì˜ˆ: user@example.com"
          required
        >
        <div class="help-text">
          <strong>í•„ìˆ˜:</strong> ì‚¬ìš©ì ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”<br>
          ì—…ë¬´í˜‘ì¡°, ìƒë‹´ ìš”ì²­, êµìœ¡ì› ìš”ì²­, íšŒì˜ ì•Œë¦¼ì„ ë°›ìœ¼ë ¤ë©´ ë°˜ë“œì‹œ í•„ìš”í•©ë‹ˆë‹¤
        </div>
      </div>

      <div class="form-group">
        <label for="polling-interval">í´ë§ ê°„ê²© (ì´ˆ)</label>
        <input 
          type="number" 
          id="polling-interval" 
          min="10" 
          max="300" 
          value="10"
          required
        >
        <div class="help-text">ê¶Œì¥: 10ì´ˆ (10-300ì´ˆ)</div>
      </div>

      <div class="form-group">
        <label for="notification-types">ì•Œë¦¼ íƒ€ì…</label>
        <select id="notification-types">
          <option value="all">ëª¨ë“  ì•Œë¦¼</option>
          <option value="customer_edit">ê³ ê° ìˆ˜ì • ë‚´ì—­ (ê´€ë¦¬ì)</option>
          <option value="work_cooperation">ì—…ë¬´í˜‘ì¡° ìš”ì²­</option>
          <option value="sales_consultation">ìƒë‹´ ìš”ì²­</option>
          <option value="institution_request">êµìœ¡ì› ìš”ì²­</option>
          <option value="meeting">íšŒì˜ ì•Œë¦¼</option>
        </select>
        <div class="help-text">ë°›ì„ ì•Œë¦¼ íƒ€ì…ì„ ì„ íƒí•˜ì„¸ìš”</div>
      </div>

      <div class="status-box" id="status-box">
        <div class="status-item">
          <span class="status-label">í˜„ì¬ ì´ë©”ì¼:</span>
          <span class="status-value" id="status-email">ë¡œë”© ì¤‘...</span>
        </div>
        <div class="status-item">
          <div class="status-label">ì•Œë¦¼ ìƒíƒœ:</div>
          <span class="status-value" id="status-enabled">ë¡œë”© ì¤‘...</span>
        </div>
      </div>

      <button type="button" class="btn btn-secondary" id="test-api-btn">API ì—°ê²° í…ŒìŠ¤íŠ¸</button>
      <button type="button" class="btn btn-secondary" id="test-notification-btn">í…ŒìŠ¤íŠ¸ ì•Œë¦¼</button>
      <button type="button" class="btn btn-secondary" id="clear-history-btn" style="background: #ff9800; color: white;">ì•Œë¦¼ íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™”</button>
      <button type="submit" class="btn btn-primary">ì„¤ì • ì €ì¥</button>
    </form>
  </div>

  <script>
    // Electron APIëŠ” preload.jsë¥¼ í†µí•´ ë…¸ì¶œë¨
    const ipcRenderer = {
      invoke: (channel, ...args) => window.electronAPI.invoke(channel, ...args),
      on: (channel, callback) => window.electronAPI.on(channel, callback),
      removeListener: (channel, callback) => window.electronAPI.removeListener(channel, callback)
    };

    let config = {};
    let enabledToggle = null;

    // ì„¤ì • ë¡œë“œ
    async function loadConfig() {
      try {
        config = await ipcRenderer.invoke('get-config');
        console.log('ğŸ“¥ ì„¤ì • ë¡œë“œ:', JSON.stringify(config, null, 2));
        console.log('ğŸ“§ ë¡œë“œëœ ì´ë©”ì¼:', config.email || '(ì—†ìŒ)', 'íƒ€ì…:', typeof config.email);

        // í¼ì— ì„¤ì • ê°’ ì±„ìš°ê¸°
        document.getElementById('api-url').value = config.apiUrl || 'http://localhost:3000/api/notifications';
        document.getElementById('email').value = config.email || '';
        document.getElementById('polling-interval').value = (config.pollingInterval || 10000) / 1000;
        document.getElementById('notification-types').value = config.types || 'all';

        // í† ê¸€ ìƒíƒœ ì„¤ì •
        enabledToggle = document.getElementById('enabled-toggle');
        if (config.enabled !== false) {
          enabledToggle.classList.add('active');
        } else {
          enabledToggle.classList.remove('active');
        }

        // ìƒíƒœ ì—…ë°ì´íŠ¸
        updateStatus();
      } catch (error) {
        console.error('âŒ ì„¤ì • ë¡œë“œ ì˜¤ë¥˜:', error);
      }
    }

    // ìƒíƒœ ì—…ë°ì´íŠ¸
    function updateStatus() {
      const emailStatus = document.getElementById('status-email');
      const enabledStatus = document.getElementById('status-enabled');
      const warningBox = document.getElementById('warning-box');
      const warningText = document.getElementById('warning-text');

      if (config.email && config.email.trim()) {
        emailStatus.textContent = config.email;
        emailStatus.className = 'status-value success';
        warningBox.style.display = 'none';
      } else {
        emailStatus.textContent = '(ì„¤ì •ë˜ì§€ ì•ŠìŒ)';
        emailStatus.className = 'status-value error';
        warningBox.style.display = 'block';
        warningText.textContent = 'âš ï¸ ì´ë©”ì¼ì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì—…ë¬´í˜‘ì¡°, ìƒë‹´, êµìœ¡ì›, íšŒì˜ ì•Œë¦¼ì„ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
      }

      if (config.enabled !== false) {
        enabledStatus.textContent = 'í™œì„±í™”ë¨';
        enabledStatus.className = 'status-value success';
      } else {
        enabledStatus.textContent = 'ë¹„í™œì„±í™”ë¨';
        enabledStatus.className = 'status-value error';
      }
    }

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
    function setupEventListeners() {
      // í† ê¸€ í´ë¦­
      enabledToggle = document.getElementById('enabled-toggle');
      enabledToggle.addEventListener('click', async () => {
        enabledToggle.classList.toggle('active');
        const enabled = enabledToggle.classList.contains('active');
        
        console.log('ğŸ”„ í† ê¸€ ìƒíƒœ ë³€ê²½:', enabled);
        
        const currentConfig = await ipcRenderer.invoke('get-config');
        const newConfig = {
          ...currentConfig,
          enabled: enabled
        };
        
        const result = await ipcRenderer.invoke('update-config', newConfig);
        if (result.success) {
          config = result.config;
          updateStatus();
        }
      });

      // í¼ ì œì¶œ
      document.getElementById('config-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const saveBtn = document.querySelector('button[type="submit"]');
        saveBtn.disabled = true;
        saveBtn.textContent = 'ì €ì¥ ì¤‘...';

        try {
          // ì´ë©”ì¼ ì…ë ¥ í•„ë“œì—ì„œ ì§ì ‘ ê°’ ê°€ì ¸ì˜¤ê¸°
          const rawEmailInput = document.getElementById('email');
          const emailRawValue = rawEmailInput.value;
          const emailTrimmedValue = emailRawValue.trim();
          
          console.log('--- ğŸ“§ Renderer ì´ë©”ì¼ ê°’ í™•ì¸ (ì €ì¥ ì§ì „) ---');
          console.log('1. í•„ë“œ ID:', rawEmailInput.id);
          console.log('2. ì…ë ¥ëœ ì›ë³¸ ê°’ (emailRawValue):', emailRawValue, `(ê¸¸ì´: ${emailRawValue.length})`);
          console.log('3. trim() ì²˜ë¦¬ëœ ìµœì¢… ê°’ (emailTrimmedValue):', emailTrimmedValue, `(ê¸¸ì´: ${emailTrimmedValue.length})`);
          console.log('-------------------------------------------');
          
          const enabled = enabledToggle.classList.contains('active');
          const email = emailTrimmedValue;
          const apiUrl = document.getElementById('api-url').value || 'http://localhost:3000/api/notifications';
          const pollingInterval = parseInt(document.getElementById('polling-interval').value) * 1000;
          const types = document.getElementById('notification-types').value;

          console.log('ğŸ’¾ ì €ì¥ ì‹œì‘:', {
            email,
            emailType: typeof email,
            emailLength: email.length,
            enabled,
            apiUrl,
            pollingInterval,
            types
          });

          // ì´ë©”ì¼ ê²€ì¦
          if (!email) {
            const confirm = window.confirm(
              'âš ï¸ ì´ë©”ì¼ì´ ì—†ìŠµë‹ˆë‹¤.\n' +
              'ì—…ë¬´í˜‘ì¡°, ìƒë‹´, êµìœ¡ì›, íšŒì˜ ì•Œë¦¼ì„ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n' +
              'ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?'
            );
            if (!confirm) {
              saveBtn.disabled = false;
              saveBtn.textContent = 'ì„¤ì • ì €ì¥';
              return;
            }
          }

          const newConfig = {
            apiUrl: apiUrl,
            email: email, // ë¹ˆ ë¬¸ìì—´ë„ í—ˆìš©
            userId: '', // userIdëŠ” í•­ìƒ ë¹ˆ ë¬¸ìì—´
            pollingInterval: pollingInterval,
            types: types,
            enabled: enabled
          };

          // IPC í˜¸ì¶œ ì§ì „ newConfig í™•ì¸
          console.log('4. ìµœì¢… newConfig.email:', email);
          console.log('ğŸ“¤ ì €ì¥í•  ì„¤ì •:', JSON.stringify(newConfig, null, 2));
          console.log('ğŸ“¤ ì´ë©”ì¼ í•„ë“œ ê°’ í™•ì¸:', {
            rawValue: document.getElementById('email').value,
            trimmedValue: email,
            length: email.length,
            isEmpty: email.length === 0
          });

          const result = await ipcRenderer.invoke('update-config', newConfig);

          if (result.success) {
            console.log('âœ… ì €ì¥ ì„±ê³µ:', JSON.stringify(result.config, null, 2));
            console.log('ğŸ“§ ì €ì¥ëœ ì´ë©”ì¼:', result.config?.email || '(ì—†ìŒ)', 'íƒ€ì…:', typeof result.config?.email);

            // ì €ì¥ëœ ì„¤ì •ìœ¼ë¡œ ì—…ë°ì´íŠ¸
            config = result.config;

            // í¼ í•„ë“œ ì—…ë°ì´íŠ¸ (ì €ì¥ëœ ê°’ìœ¼ë¡œ)
            document.getElementById('email').value = result.config.email || '';
            document.getElementById('polling-interval').value = (result.config.pollingInterval || 10000) / 1000;
            document.getElementById('notification-types').value = result.config.types || 'all';

            // í† ê¸€ ìƒíƒœ ì—…ë°ì´íŠ¸
            if (result.config.enabled !== false) {
              enabledToggle.classList.add('active');
            } else {
              enabledToggle.classList.remove('active');
            }

            // ìƒíƒœ ì—…ë°ì´íŠ¸
            updateStatus();

            // ì„±ê³µ ë©”ì‹œì§€
            if (result.config.email && result.config.email.trim()) {
              alert('âœ… ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } else {
              alert('âš ï¸ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆì§€ë§Œ ì´ë©”ì¼ì´ ì—†ìŠµë‹ˆë‹¤. ì—…ë¬´í˜‘ì¡°, ìƒë‹´, êµìœ¡ì›, íšŒì˜ ì•Œë¦¼ì„ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
          } else {
            console.error('âŒ ì €ì¥ ì‹¤íŒ¨:', result);
            alert('âŒ ì„¤ì • ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
          }
        } catch (error) {
          console.error('âŒ ì €ì¥ ì˜¤ë¥˜:', error);
          alert('âŒ ì„¤ì • ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
        } finally {
          saveBtn.disabled = false;
          saveBtn.textContent = 'ì„¤ì • ì €ì¥';
        }
      });

      // API ì—°ê²° í…ŒìŠ¤íŠ¸
      document.getElementById('test-api-btn').addEventListener('click', async () => {
        const btn = document.getElementById('test-api-btn');
        btn.disabled = true;
        btn.textContent = 'í…ŒìŠ¤íŠ¸ ì¤‘...';

        try {
          // í˜„ì¬ ì„¤ì • í™•ì¸
          const currentConfig = await ipcRenderer.invoke('get-config');
          console.log('ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ ì„¤ì • í™•ì¸:', currentConfig);
          
          if (!currentConfig.email && !currentConfig.userId) {
            alert('âš ï¸ ì´ë©”ì¼ì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\n\nì„¤ì •ì—ì„œ ì´ë©”ì¼ì„ ì…ë ¥í•œ í›„ "ì„¤ì • ì €ì¥"ì„ í´ë¦­í•˜ì„¸ìš”.');
            btn.disabled = false;
            btn.textContent = 'API ì—°ê²° í…ŒìŠ¤íŠ¸';
            return;
          }
          
          const result = await ipcRenderer.invoke('test-api-connection');
          console.log('ğŸ§ª í…ŒìŠ¤íŠ¸ ê²°ê³¼:', result);
          
          if (result.success) {
            let message = `âœ… API ì—°ê²° ì„±ê³µ!\n\n`;
            message += `- ìƒíƒœ: ${result.status || 200}\n`;
            message += `- ì•Œë¦¼ ê°œìˆ˜: ${result.count || 0}ê°œ\n`;
            if (result.data && result.data.last_checked) {
              message += `- ë§ˆì§€ë§‰ í™•ì¸: ${new Date(result.data.last_checked).toLocaleString()}`;
            }
            alert(message);
          } else {
            let message = `âŒ API ì—°ê²° ì‹¤íŒ¨\n\n`;
            message += `ì˜¤ë¥˜: ${result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}\n`;
            if (result.code) {
              message += `ì½”ë“œ: ${result.code}\n`;
            }
            if (result.status) {
              message += `HTTP ìƒíƒœ: ${result.status}`;
            }
            message += `\n\ní™•ì¸ ì‚¬í•­:\n`;
            message += `1. Next.js ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ê°€ìš”? (http://localhost:3000)\n`;
            message += `2. ì´ë©”ì¼ì´ ì˜¬ë°”ë¥´ê²Œ ì €ì¥ë˜ì—ˆë‚˜ìš”?\n`;
            message += `3. API URLì´ ì˜¬ë°”ë¥¸ê°€ìš”? (${currentConfig.apiUrl})`;
            alert(message);
          }
        } catch (error) {
          console.error('âŒ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜:', error);
          alert(`âŒ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`);
        } finally {
          btn.disabled = false;
          btn.textContent = 'API ì—°ê²° í…ŒìŠ¤íŠ¸';
        }
      });

      // í…ŒìŠ¤íŠ¸ ì•Œë¦¼
      document.getElementById('test-notification-btn').addEventListener('click', async () => {
        try {
          await ipcRenderer.invoke('test-notification');
        } catch (error) {
          console.error('í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ì˜¤ë¥˜:', error);
        }
      });

      // ì•Œë¦¼ íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™”
      document.getElementById('clear-history-btn').addEventListener('click', async () => {
        const btn = document.getElementById('clear-history-btn');
        const originalText = btn.textContent;
        
        if (!confirm('âš ï¸ ì•Œë¦¼ íˆìŠ¤í† ë¦¬ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ë ‡ê²Œ í•˜ë©´:\n- ì´ë¯¸ í™•ì¸í•œ ì•Œë¦¼ì´ ë‹¤ì‹œ í‘œì‹œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n- last_checkedê°€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤\n- ì¤‘ë³µ ë°©ì§€ ëª©ë¡ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤')) {
          return;
        }
        
        btn.disabled = true;
        btn.textContent = 'ì´ˆê¸°í™” ì¤‘...';
        
        try {
          const result = await ipcRenderer.invoke('clear-processed-notifications');
          
          if (result.success) {
            alert(`âœ… ì•Œë¦¼ íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™” ì™„ë£Œ!\n\n${result.clearedCount || 0}ê°œì˜ ì•Œë¦¼ IDê°€ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.\nì´ì œ ëª¨ë“  ì•Œë¦¼ì„ ë‹¤ì‹œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
            console.log('âœ… ì•Œë¦¼ íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™” ì„±ê³µ:', result);
          } else {
            alert('âŒ ì´ˆê¸°í™” ì‹¤íŒ¨');
          }
        } catch (error) {
          console.error('âŒ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
          alert('âŒ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
        } finally {
          btn.disabled = false;
          btn.textContent = originalText;
        }
      });
    }

    // ì´ˆê¸°í™”
    loadConfig().then(() => {
      setupEventListeners();
    });
  </script>
</body>
</html>

